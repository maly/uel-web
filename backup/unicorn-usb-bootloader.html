<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"https://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from www.uelectronics.info/unicorn-usb-bootloader by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 23 Dec 2011 16:45:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Unicorn USB bootloader | µ[micro]electronics info</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="sites/uelectronics.info/themes/abac/favicon.ico" type="image/x-icon" />
		<link type="text/css" rel="stylesheet" media="all" href="sites/uelectronics.info/files/css/css_59fc7402156178bc3780ddedc4c61792.css" />
		





		<style type="text/css" media="print">@import "sites/uelectronics.info/themes/abac/print.css";</style>
<meta name="description" content="Unicorn USB bootloader | µ[micro]electronics info"><meta name="description" content="Unicorn USB bootloader | µ[micro]electronics info"></head>
<body class="sidebar-left">
<div class="main">
<div class="adsense" style="float:right">
<!--ad728x90--><iframe src="https://rcm-na.amazon-adsystem.com/e/cm?t=uelectronics-20&o=1&p=48&l=ur1&category=firetv&banner=09FPYM180BBTMF524F82&f=ifr" width="728" height="90" scrolling="no" border="0" marginwidth="0" style="border:none;" frameborder="0"></iframe>
</div>  
	<div class="heada">
		<div class="headMenu">
											</div>
		<div class="search">
					</div>
	</div>
	<div class="headb">
		<div class="logo"><a href="index.html" title=""><img src="sites/uelectronics.info/files/abac_logo.png" alt="" id="logo" /></a>				
		</div>
		<div class="welcome"><h1><a href="index.html" title="µ[micro]electronics info"><span>µ[micro]electronics info</span></a></h1>			
			<p><div id="block-block-20" class="clear-block block block-block">


  <div class="content"><p style="clear:both">A weblog focused on interesting circuits, ideas, schematics and other information about microelectronics and microcontrollers.</p>
</div>
</div>
</p>
		</div>
	</div>
	<div class="cont">
		<div class="leftColumn">
			<div id="block-menu-primary-links" class="clear-block block block-menu">

  <h3>Primary links</h3>

  <div class="content"><ul class="menu"><li class="leaf first"><a href="primarni-kategorie/circuits.html" title="">Circuits</a></li>
<li class="leaf"><a href="primarni-kategorie/my-projects.html" title="">My Projects</a></li>
<li class="leaf"><a href="primarni-kategorie/programming.html" title="">Programming</a></li>
<li class="collapsed"><a href="primary-categories/microprocessors.html" title="">Microprocessors</a></li>
<li class="collapsed"><a href="primarni-kategorie/microcontrollers.html" title="">Microcontrollers</a></li>
<li class="leaf"><a href="primarni-kategorie/other.html" title="">Other</a></li>
<li class="leaf"><a href="tagadelic.html" title="All categories and tags">Tag index</a></li>
<li class="leaf"><a href="contact.html" title="">Contact</a></li>
<li class="leaf last"><a href="https://www.php-suit.com/hostmonster" title="Recommended hosting">Hosting</a></li>
</ul></div>
</div>
<div id="block-block-26" class="clear-block block block-block">

  <h3>E-books</h3>

  <div class="content"><script charset="utf-8" type="text/javascript" src="https://ws.amazon.com/widgets/q?ServiceVersion=20070822&amp;MarketPlace=US&amp;ID=V20070822/US/dein-20/8001/1d72d7a3-81c8-4cb4-9e83-271fc4c4bf1e"></script></div>
</div>
<div id="block-block-17" class="clear-block block block-block">


  <div class="content"><!--ad160x600--><iframe src="https://rcm-na.amazon-adsystem.com/e/cm?t=uelectronics-20&o=1&p=14&l=ur1&category=computers_accesories&banner=0T2F1JTWT0V716ATBW02&f=ifr" width="160" height="600" scrolling="no" border="0" marginwidth="0" style="border:none;" frameborder="0"></iframe></div>
</div>
<div id="block-block-7" class="clear-block block block-block">


  <div class="content"><form method="get" action="https://www.google.com/custom" target="_top"><a href="https://www.google.com/"><img src="../www.google.com/logos/Logo_25wht.gif" border="0" alt="Google" align="middle" /></a><input type="hidden" name="domains" value="www.uelectronics.info" /> <label for="sbi">Enter your search terms</label><br />
<input type="text" name="q" size="18" maxlength="255" value="" id="sbi" /> <input type="hidden" name="sitesearch" value="www.uelectronics.info"  style="display: none" /> <input type="submit" name="sa" value="Search" id="sbb" /> <input type="hidden" name="client" value="pub-3772893178572611" style="display: none" /> <input type="hidden" name="forid" value="1" style="display: none" /> <input type="hidden" name="channel" value="3735043692" style="display: none" /> <input type="hidden" name="ie" value="UTF-8" style="display: none" /> <input type="hidden" name="oe" value="UTF-8" style="display: none" /> <input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:77;LW:100;L:https://www.uelectronics.info/files/abac_logo.png;S:https://www.uelectronics.info;LP:1;FORID:1" style="display: none" /><br />
<input type="hidden" name="hl" value="en" style="display: none" /></form>
</div>
</div>
<div id="block-block-6" class="clear-block block block-block">


  <div class="content">

</p>
<!--p>
<script language="JavaScript" type="text/javascript" src="https://www.blogcatalog.com/rate-button.js.php?id=4398901"></script>
<br /><a href="https://www.blogcatalog.com/in/4398901" title="Technology Blogs - Blog Catalog Blog Directory"><img src="https://www.blogcatalog.com/rank/4398901.gif" alt="My BlogCatalog BlogRank"></a>
</p><p><a href="https://www.facebook.com/pages/Microelectronics-information-blog/52431323054"><img src="https://www.uelectronics.info/sites/uelectronics.info/files/images/find_us_on_facebook_badge.gif" alt="Find us on Facebook" /></a></p--><p>
<a href="https://feeds.feedburner.com/micro-electronics"><img src="https://feeds.feedburner.com/~fc/micro-electronics?bg=99CCFF&amp;fg=444444&amp;anim=0" height="26" width="88" style="border:0" alt="" /></a></p>
<script src="https://feeds.feedburner.com/~s/micro-electronics?i=https://www.uelectronics.info" type="text/javascript" charset="utf-8"></script></div>
</div>
<div id="block-block-9" class="clear-block block block-block">

  <h3>Disclaimer</h3>

  <div class="content"><p>Because I have not tested all electronic circuits mentioned on this pages, I cannot attest to their accuracy; therefore, I do not provide a warranty of any kind and cannot be held responsible in any manner.</p>
<p><a href="https://mailhide.recaptcha.net/d?k=01Vo4gBys3Uh5rngt5Ot_9Vg==&amp;c=MN3aDdCSbsPU4CCYEhk1P2Tph2EI_G0Gx4uuvhUe984=" onclick="window.open('https://mailhide.recaptcha.net/d?k=01Vo4gBys3Uh5rngt5Ot_9Vg==&amp;c=MN3aDdCSbsPU4CCYEhk1P2Tph2EI_G0Gx4uuvhUe984=', '', 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=500,height=300'); return false;" title="Reveal this e-mail address">My e-mail</a></p>
<p><a href="https://mmaly.net/">My website</a></p>
<p></p>
</div>
</div>
			
		</div>
		<div class="center">			
						<div class="breadcrumb"><a href="index.html">Home</a></div>			<div id="block-block-18" class="clear-block block block-block">


  <div class="content"><!--ad468x60--><iframe src="https://rcm-na.amazon-adsystem.com/e/cm?t=uelectronics-20&o=1&p=26&l=ur1&category=computers_accesories&banner=1SKRXV416ZYVKCEGXQR2&f=ifr" width="468" height="60" scrolling="no" border="0" marginwidth="0" style="border:none;" frameborder="0"></iframe></div>
</div>
			
			<h1>Unicorn USB bootloader</h1>				
															
<div id="node-272" class="node">



      <span class="submitted">23. July 2008 - 19:26 — admin</span>
  
  <div class="content">
    <p>My first experiment: How to modify standard Microchip's USB bootloader for the <span class="contextlinks contextlinks-link"><span class="contextlinks-text"><a href="unicorn-usb-experimenter-kit.html">Unicorn experimenter kit</a></span></span>.</p>
<p>As I wrote a few days ago, I'm happy owner of the <span class="contextlinks contextlinks-link"><span class="contextlinks-text"><a href="unicorn-usb-experimenter-kit.html">Unicorn experimenter kit</a></span></span> now. My first experiment with this kit (omitting the "Hello world" on LCD) was an attempt to run standard <span class="contextlinks contextlinks-link"><span class="contextlinks-text"><a href="https://www.microchip.com/stellent/idcplg?IdcService=SS_GET_PAGE&amp;nodeId=2124&amp;param=en022627">Microchip's USB bootloader</a></span></span>.</p>
<p>I'm not sure if I may distribute whole source code. So I describe only the changes I've made in the codes step by step:</p>
<p>1. Download and install <span class="contextlinks contextlinks-link"><span class="contextlinks-text"><a href="https://www.microchip.com/stellent/idcplg?IdcService=SS_GET_PAGE&amp;nodeId=2124&amp;param=en022627">Microchip's USB bootloader</a></span></span></p>
<p>2. You can find the USB bootloader in c:\MCHPFSUSB\fw\boot (the path can be different)</p>
<p>3. The most "system dependent" information are in io_cfg.h file. I've slightly modify the LED information this way:<br />
<code>#define mInitAllLEDs()      LATC &amp;= 0xfd; TRISC &amp;= 0xFD;<br />
#define mLED_1              LATCbits.LATC1<br />
#define mLED_2              LATCbits.LATC1<br />
#define mLED_3              LATCbits.LATC1<br />
#define mLED_4              LATCbits.LATC1<br />
</code></p>
<p>and the "switches" part:</p>
<p><code>#define mInitAllSwitches()  TRISBbits.TRISB0=1;TRISBbits.TRISB1=1;<br />
#define mInitSwitch2()      TRISBbits.TRISB0=1;<br />
#define mInitSwitch3()      TRISBbits.TRISB1=1;<br />
#define sw2                 PORTBbits.RB0<br />
#define sw3                 PORTBbits.RB1</code></p>
<p>4. I've slightly modified the main.c file too. I've changed the main() function this way:<br />
<code>void main(void)<br />
{<br />
    mInitAllLEDs();<br />
    mInitAllSwitches();<br />
	mLED_1_Off();<br />
	//Check Bootload Mode Entry Condition<br />
	if (sw2 + sw3) {<br />
		_asm goto RM_RESET_VECTOR _endasm<br />
	}	else {<br />
		mLED_1_On();<br />
	}<br />
    //Bootload Mode<br />
    mInitializeUSBDriver();<br />
...</code></p>
<p>other code remained unchanged.</p>
<p>5. The MCHPUSB.mcw has its own configuration data; they're, fortunatelly, compatible with the Unicorn. So after these changes you can directly compile the code and programm FLASH.</p>
<p>With this bootloader you can switch the Unicorn  to the "boot mode" simply: Hold the both switches SW1 and SW2 and plug Unicorn into the USB. The LED will flash (if you hacked the Unicorn PCB error as I <span class="contextlinks contextlinks-link"><span class="contextlinks-text"><a href="unicorn-usb-experimenter-kit.html">described</a></span></span>) and your PC will find "The PIC18F4550 device". System will ask you for the drivers; you should provide the ones located in "MCHPFSUSB\Pc\MCHPUSB Driver\Release".</p>
<p>Once you have Unicorn with bootloader, you can upload your SW using the PDFSUSB.exe utility (MCHPFSUSB\PC\Pdfsusb).</p>
<p>Good luck!</p>
  </div>

  <div class="clear-block clear">
    <div class="meta">
          <div class="terms"><ul class="links inline"><li class="taxonomy_term_9 first"><a href="primarni-kategorie/microcontrollers/microchip-pic.html" rel="tag" title="">Microchip PIC</a></li>
<li class="taxonomy_term_147"><a href="taxonomy/term/147.html" rel="tag" title="">PIC18F</a></li>
<li class="taxonomy_term_282"><a href="tags/pic18f4550.html" rel="tag" title="">PIC18F4550</a></li>
<li class="taxonomy_term_137"><a href="taxonomy/term/137.html" rel="tag" title="">software</a></li>
<li class="taxonomy_term_85 last"><a href="tags/usb.html" rel="tag" title="">USB</a></li>
</ul></div>
        </div>

          <div class="links"><ul class="links inline"><li class="addtoany first last"><span>
		<a class="da2a_button" href="https://www.addtoany.com/share_save?linkurl=http%3A%2F%2Fwww.uelectronics.info%2Funicorn-usb-bootloader&amp;linkname=Unicorn%20USB%20bootloader" id="da2a_1"></a>
		
		</span></li>
</ul></div>
      </div>

</div>		</div>
	</div>
	<div class="bottom">	
		                	
				
	</div>
	<div class="copy">
		<p>Powered by <a href="https://www.drupal.org/">Drupal</a> - <!-- Please do not remove this command line --> Design by <a href="https://www.artinet.ru/">Artinet</a></p>
	</div>
</div>


</body>

<!-- Mirrored from www.uelectronics.info/unicorn-usb-bootloader by HTTrack Website Copier/3.x [XR&CO'2008], Fri, 23 Dec 2011 16:45:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>
